---
layout: post
title:  "読書メモ：基本の「き」 境界値分析・同値分割法』"
date:   2025-2-16 20:20:11 +0900
categories: テスト
---

## 用語
| 単語 | 意味 |
| -- | -- |
| 境界値 | 出力結果に変化が生じる境界の値のこと |
| 同値クラス | 出力結果が同じ結果となる値の集合 |

## 境界値
「テスト結果が、59点は不合格。60点は合格。」とした場合、59点・60点がそれぞれ境界値
（テストが必ず整数で点数がつく前提）

### 境界値分析

```
0 <= x < 100 ... OK
```
という条件の場合、
- `0 <= x` に注目
  - ok となる最小値は、0
  - ng となる最大値は、-1
- `x < 100` に注目
  - ok となる最小値は、99
  - ng となる最大値は、100

という分析が可能で、同条件における境界値は以下のようになる
- 出力結果 ok となる最小値0, 最大値99
- 出力結果 ng となる最小値-1, 最大値100

### 境界値の注意点
#### 日本語表記だと認識の不一致が起こりやすい
統合表記や数直線を用いて認識ずれを防ぐ

「13歳から20歳までの入場料は500円である」
- 12歳はいくら？
- 13歳は500円？
- 20歳は500円？
- 21歳はいくら？

#### 単位を明確にする
- 整数なのか小数を含むのか（何桁まで有効なのか）
- 分秒まで含めるのか
といった最小の単位を明確にする


## 同値クラス分割
入力値による出力結果を、有効と無効の"同値クラス"に区分する

数のように範囲が一続き（連続した値）になる場合もあれば、そうならない場合もある。
- パスワードに使用する文字で「I（英大文字のアイ）」「l（英小文字のエル）」「1（数字のイチ）」は識別しにくいので無効
という条件の時、同値クラスは以下のようになる
```
- 有効同値クラス： I以外の英大文字 / l以外の英小文字 / 1以外の数字
- 無効同値クラス： 英大文字のI / 英小文字のl / 数字の1
```

### 同値クラス分割テストとは？
入力値に、各同値クラスのそれぞれの代表の値を入力し、出力結果を確認すること

```
- 有効同値クラス： 0 <= x <= 100 の代表値
- 無効同値クラス： 有効同値クラス以外の代表値
```

代表値はなんでも構わないが、境界値分析テストと違うよ、と示す意味でも範囲の中間を選択するとよい。

入力可能なすべての入力値でテストするのが理想ではあるが、現実的ではない。
そこで同値クラス分割テストを実施することで、テスト工数を縮小することができる。

**注意!!**
同値クラスの中にイレギュラーな不具合があった場合、見逃すリスクがある。

また、同値クラス分割が正しく出来ている前提でないとテスト効果が下がってしまう。
なので、境界値分析テストと併用することが一般的。

## 境界値分析・同値クラス分割のサンプル

デシジョンテーブルにしてみよう

| -- | ルール | 1 | 2 | 3 | 4 | 5 | 7 | 8 | 9 | 10 | 11 | 13 |
| -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- |
| 条件（時刻） | 9:00より前 or 16:30より後 | Y | n | n | n | n | n | n | n | n | n | n |
|  | 9:00 - 16:00より前 | n | Y | Y | Y | Y | Y | n | n | n | n | n |
|  | 16:00 - 16:30 | n | n | n | n | n | n | Y | Y | Y | Y | Y |
| 条件（年齢） | 年齢 | DC | 6歳以下 | 13歳未満 or 65歳以上 | 15歳以下 | 20歳未満 | 20歳 - 65歳未満 | 6歳以下 | 13歳未満 or 65歳以上 | 15歳以下 | 20歳未満 | 20歳 - 65歳未満 |
| 動作 | 購入不可 | x | - | - | - | - | - | - | - | - | - | - |
|  | 100%割引 | - | x | - | - | - | - | x | - | - | - | - |
|  | 50%割引 | - | - | x | - | - | - | - | - | - | - | - |
|  | 500円引き | - | - | - | x | - | - | - | - | - | - | - |
|  | 300円引き | - | - | - | - | x | - | - | - | - | - | - |
|  | 値引きなし | - | - | - | - | - | x | - | - | - | - | - |
|  | 50%割引 & 200円割引 | - | - | - | - | - | - | - | x | - | - | - |
|  | 500円引き & 200円割引 | - | - | - | - | - | - | - | - | x | - | - |
|  | 300円引き & 200円割引 | - | - | - | - | - | - | - | - | - | x | - |
|  | 200円引き | - | - | - | - | - | - | - | - | - | - | x |

写経（表A）
| 年齢 | 0-6 | 7-12 | 13-15 | 16-19 | 20-64 | 65 |
| -- | -- | -- | -- | -- | -- | -- |
| 時刻/割引 | 無料 | 半額 | 500円引き | 300円引き | - | 半額 |
| 9:00-15:59 | 0円 | 1000円 | 1500円 | 1700円 | 2000円 | 1000円 |
| 16:00-16:30 | 0円 | 800円 | 1300円 | 1500円 | 1800円 | 800円 |

写経（表B）
| 年齢/時刻 | 8:59 | 9:00 | 15:59 | 16:00 | 16:30 | 16:31 |
| -- | -- | -- | -- | -- | -- | -- |
| 6 | x | 0 | 0 | 0 | 0 | x |
| 7 | x | 1000 | 1000 | 800 | 800 | x |
| 12 | x | 1000 | 1000 | 800 | 800 | x |
| 13 | x | 1500 | 1500 | 1300 | 1300 | x |
| 15 | x | 1500 | 1500 | 1300 | 1300 | x |
| 16 | x | 1700 | 1700 | 1500 | 1500 | x |
| 19 | x | 1700 | 1700 | 1500 | 1500 | x |
| 20 | x | 2000 | 2000 | 1800 | 1800 | x |
| 64 | x | 2000 | 2000 | 1800 | 1800 | x |
| 65 | x | 1000 | 1000 | 800 | 800 | x |

表Bは、書きながら仕様が頭に入ってくるのが良かった
テストにもそのまま使える点もよさそう
値をハードコーディングしているので、ベース料金が変わった時に書き換えないと「嘘」になる点が残念
かといって、100%割引のような表記が続くと可読性が著しく悪い

**テスト目的には？**
表Bが良さそう
ベースとなる金額をどこかのセルに入れておいて、具体的な金額部分は数式で埋めて置くとよさそう。

**仕様の整理目的には?**
デシジョンテーブルが良さそう
購入負荷の時間帯は、表外に`（上記の時間外は購入不可）`とでも書けばよいのかもしれない。


**書き直してみたデシジョンテーブル**
| -- | ルール | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- |
| 条件（年齢） | 年齢 | 0-6 | 0-6 | 7-12 |  65 -  | 7-12 |  65 -  | 13-15 | 13-15 | 16-19 | 16-19 | 20-64 | 20-64 |
| 条件（時刻） | 9:00 - 16:00より前 | Y | n | Y | n | Y | n | Y | n | Y | n |
|  | 16:00 - 16:30 | n | Y | n | Y | n | Y | n | Y | n | Y |
| 動作 | 100%割引 | x | x | - | - | - | - | - | - | - | - |
|  | 50%割引 | - | - | x | - | - | - | - | - | - | - |
|  | 50%割引 & 200円割引 | - | - | - | x | - | - | - | - | - | - |
|  | 500円引き | - | - | - | - | x | - | - | - | - | - |
|  | 500円引き & 200円割引 | - | - | - | - | - | x | - | - | - | - |
|  | 300円引き | - | - | - | - | - | - | x | - | - | - |
|  | 300円引き & 200円割引 | - | - | - | - | - | - | - | x | - | - |
|  | 値引きなし | - | - | - | - | - | - | - | - | x | - |
|  | 200円引き | - | - | - | - | - | - | - | - | - | x |

